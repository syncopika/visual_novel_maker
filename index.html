<!DOCTYPE html>

<html>

<head>
	<title>simple 'visual novel' thingy</title>
	<meta charset='utf-8'>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src='scripts/Screen.js'></script>
	<script src='scripts/SetScene.js'></script>
	<script src='scripts/Game.js'></script>
	<script src='demos/catGame1.js'></script>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
</head>

<style>
#screen{
	display: block;
	margin: 0 auto;
	text-align: center;
}

#rowScreen{
	position: relative;
}

#rowDialog{
	margin: 0 auto;
	border: #fff 1px dotted;
}

.spacer {
	height: 20px;
}

#footer{
	height: 100px;
}

ul{
	padding: 0;
}

#title{
	text-align: center;
}

p, h2{
	color: #fff;
}

h3{
	font-family: monospace;
}

a:hover{
	color: #fff;
}

body{
	background-color: #36454f;
	touch-action: manipulation;
}

.row{
	text-align: center;
}

.btn-primary{
	background-color: #0199de;
	color: #fff;
	padding: 5px 8px 5px 8px;
	letter-spacing: 1px;
	text-transform: uppercase;
	margin-top: 10%;
}

#menu{
	text-align: center;
	margin-left: 1%;
	margin-right: 1%;
	border: #fff solid 1px;
	border-radius: 5px;
	padding: 0;
}

#menu li{
	list-style-type: none;
	color: #fff;
}
</style>

<body>

<div class='row'>
	<div id='title'>
		<h2> simple 'visual novel' thingy </h2>
	</div>
</div>

<div class='row'>
	<div class='col-lg-2 col-md-12 col-sm-12'>
		<div id='menu'>
			<p><b>instructions:</b> after selecting a game and clicking the start button, press spacebar (or double-tap if on mobile) to traverse the scenes.</p>
			<p>to change games after selecting one, please refresh the page!</p>
			<p>note: there may be bugs!</p>
			<h3 style='color: #fff'> choose a game: </h3>
			<ul>
				<li id='game1'><a href='#'>mr.cat's neighborhood</a></li>
				<li id='game2'><a href='#'>mystery game</a></li>
				<br />
				<li class='options'><a>option menu</a></li>
			</ul>
			<p><a href='https://github.com/syncopika/visual_novel_maker'>source</a></p>
			<br />
			<p>n.c.h works c.2016</p>
		</div>
	</div>
	
	<div class='spacer col-lg-1 col-md-12 col-sm-12'>
	</div>

	<div class='col-lg-7 col-md-12 col-sm-12' id='screen'>
		<div class='row' id='rowScreen'>
		</div>

		<div class='row' id='rowDialog'>
		</div>
	</div>
	
	<div class='spacer col-lg-2 col-md-12 col-sm-12'>
	</div>
</div>


</body>

<script>
/**
* Welcome to my 'visual novel' engine. I guess there could be other things this could be used for too. 
* It's extremely basic. Please don't expect too much ^_^
* Instructions: use spacebar to move to the next scene.

/**
* Make game here ======================================
*
**/

//simple utility functions to get only script of selected game when clicked on
//http://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml
function newScriptNode(newFile){
	
	var source = document.createElement('script');
	//source.setAttribute("type", "text/javascript");
	source.setAttribute("src", newFile);
	
	return source;

}

function getGame(oldFile, newFile){
	var targetElement = "script"; //look at script elements only
	//var targetAttr = "src"; //since script elements have "src="
	var allScripts = document.getElementsByTagName(targetElement); //this creates a collection of <script> elements
	//scripts.length - 1 to account for this script section 
	for(var i = 0; i < allScripts.length - 1; i++){
		//if a script exists and the value of attribute "src" contains the file name
		if(allScripts[i].getAttribute("src").indexOf(oldFile) > -1){
			var newScript = newScriptNode(newFile);
			allScripts[i].parentNode.replaceChild(newScript, allScripts[i]);
			break;
		}
	}
}


/** Start game here **/
$(document).ready(function(){
	// adjust depending on window size if width < 1000px
	var screenWidth = $('#screen').width();
	if(screenWidth >= 1000){
		Screen.make(900, 700);
	}else{
		// subtract 50 to ensure that the canvas will be within the width of the screen
		Screen.make(screenWidth-50, (screenWidth-50)*(7/9));
	}

	/**
	 found an interesting problem. what if i want to name one of my characters Mr.Cat? any string with a period, or any non-alpha-num char
	 will cause problems when using that string as an ID. can u come up with a function maybe that parses the string, strips it of the special
	 char, and makes the ID like MrCat or something like that?
	*/
	Screen.menuScreen("artAssets/mrcatsneighborhood.png", "col");
	Screen.setDialogBox("artAssets/dialogBar.png");

	// mr cats neighborhood
	$('#game1').click(function(){
		var curGame = document.getElementsByTagName("script")[4].getAttribute("src");
		if(curGame !== "demos/CatGame1.js"){
			getGame(curGame, "demos/CatGame1.js");
		}
	});

	//mystery game
	$('#game2').click(function(){
		var curGame = document.getElementsByTagName("script")[4].getAttribute("src");
		if(curGame !== "demos/mysteryGame1.js"){
			getGame(curGame, "demos/mysteryGame1.js");
		}
	});

});


</script>
</html>
